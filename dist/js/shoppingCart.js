"use strict";require(["config"],function(){require(["jquery","swiper","jq_cookie","common","fangdajing","details","index","goodsList"],function(e){jQuery(function(s,e){var i=new XMLHttpRequest,n=[200,304];i.onreadystatechange=function(){if(4==i.readyState&&-1!=n.indexOf(i.status)){var e=JSON.parse(i.responseText).cartlist;console.log(e),s(".goods_line").get(0).innerHTML="",s(".tol").get(0).innerHTML="",e.forEach(function(e,n){s(".goods_line").get(0).innerHTML+='<div data-guid="'+e.guid+'" class="top list last" style="margin-left: 0;">\n                <div class="check">\n                    <input type="checkbox" class="Each " name="checkItem" checked="true">\n                </div>\n                <div class="goods">\n                    <dl>\n                        <a href="/c/goods-1091160-892.html">\n                            <dt><img src="'+e.imgUrl+'"\n                                    alt=""></dt>\n                            <dd>\n                                <span>'+e.goodsName+'<i style="color:#CD6E00;">【商品编号:'+e.guid+'】</i></span>\n                            </dd>\n                        </a>\n                    </dl>\n                </div>\n                <div class="pices">￥'+e.price+'</div>\n                <div class="num">\n                    <span class="reduc">&nbsp;-&nbsp;</span>\n                    <input type="text" value="'+e.qty+'" class="itxt" minnum="1"\n                        onkeyup="this.value=this.value.replace(/D/g,\'\')"\n                        onafterpaste="this.value=this.value.replace(/D/g,\'\')">\n                    <span class="add">&nbsp;+</span>\n                </div>\n                <div class="totle">￥'+e.price*e.qty+'</div>\n                <div class="available">有货</div>\n                <a class="del">删除</a>\n            </div>',s(".num").on("click","span",function(e){if(e.preventDefault(),s(this).hasClass("reduc")){if(s(this).next().val()<=1)return!1;var n=s(this).parents(".top").attr("data-guid");i.open("get","api/shoppingCart.php?uname="+s.cookie("user")+"&btn=reduc&guid="+n)}else if(s(this).hasClass("add")){n=s(this).parents(".top").attr("data-guid");i.open("get","api/shoppingCart.php?uname="+s.cookie("user")+"&btn=add&guid="+n)}i.send(null)}),s(".itxt").on("blur",function(){var e;console.log(s(".itxt")),e=s(".itxt").get(0).value<=1?1:s(".itxt").val();var n=s(this).parents(".top").attr("data-guid");i.open("get","api/shoppingCart.php?uname="+s.cookie("user")+"&btn=val&val="+e+"&guid="+n),i.send(null)}),s(".del").on("click",function(){if(confirm("确定要删除该吗？")){var e=s(".del").parents(".top").attr("data-guid");i.open("get","api/shoppingCart.php?uname="+s.cookie("user")+"&btn=del&guid="+e),i.send(null)}else console.log("不删除")});var a=!0;s(".all").on("click",function(){a=a?(console.log(1),s(".Each").prop("checked",!1),s(".Each").parents(".goods_line").romoveClass("checked_bg"),!1):(console.log(0),s(".Each").prop("checked",!0),s(".Each").parents(".goods_line").addClass("checked_bg"),!0)})});var a=0,t=0;e.forEach(function(e,n){a+=e.price*e.qty,t+=1*e.qty}),s(".tol").get(0).innerHTML+='<span>共 <b id="number">'+t+'</b> 件商品</span><span>优惠：<b\n            id="save">￥0.00</b></span><span>总计（不含配送服务费）:<i>￥</i><b id="susum">'+a+"</b></span>"}},s.cookie("user")&&(i.open("get","api/shoppingCart.php?uname="+s.cookie("user")),i.send(null)),s(".num").on("click","span",function(e){if(e.preventDefault(),console.log(s(this)),console.log(1),s(this).hasClass("reduc")){var n=s(this).parents(".top").attr("data-guid");console.log(1),i.open("get","api/shoppingCart.php?uname="+s.cookie("user")+"&btn=reduc&guid="+n)}else if(s(this).hasClass("add")){n=s(this).parents(".top").attr("data-guid");console.log(2),i.open("get","api/shoppingCart.php?uname="+s.cookie("user")+"&btn=add&guid="+n)}i.send(null)})})})});