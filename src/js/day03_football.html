<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Document</title>
    <style>
        body{padding:50px;}
        ul{list-style: none;padding:0;margin:0;}/*reset*/
        .datalist{border:1px solid #ddd;padding:15px;}
        .datalist li{padding:15px 5px;border-bottom:1px dotted #ccc;}
        .datalist li h4{margin:0;}
        .page span{display:inline-block;margin:5px;width:40px;line-height:1.8;text-align: center;background-color:#dfdfdf;color:#666;}
        .page span.active{background-color:#fc0;color:#fff;}
    </style>
    <script>
    document.addEventListener("DOMContentLoaded",function(){
        var datalist = document.querySelector(".datalist");
        var page = document.querySelector(".page");
        var xhr = new XMLHttpRequest();
        //初次进入页面即刻请求数据
        var qty = 5;
        var currentPage = 1;
        xhr.onreadystatechange = function(){
            console.log(xhr.status);
            if(xhr.readyState == 4 && xhr.status == 200 || xhr.status == 304){
                var res = JSON.parse(xhr.responseText);
                var currentArr = res.currentArr;
                currentPage = res.currentPage;
                qty = res.qty;
                var length = res.len;
                // console.log(currentArr,currentPage,qty,length);
                    // var str = '';str
                datalist.innerHTML = currentArr.map(function(item){
                    return `<li><h4>${item.name}</h4>
                            <p>${item.content}</p></li>`
                }).join('');
                for(let i=1;i<=length;i++){
                    var span = document.createElement("span");
                    page.appendChild(span);
                    span.innerText = i;
                    if(i==currentPage){
                        span.classList.add("active");
                    }
                }
            }
        }
        xhr.open("get","../api/day03_football.php?currentPage="+currentPage+"&qty="+qty);
        xhr.send(null);
        //点击页码请求数据
        page.onclick = function(e){
            page.innerHTML = '';
            currentPage = e.target.innerText;
            console.log(currentPage);
            e.target.classList.add("active");
            xhr.open("get","../api/day03_football.php?currentPage="+currentPage+"&qty="+qty);
            xhr.send(null);
        }
    })



    </script>
</head>
<body>
    <ul class="datalist"></ul>
    <div class="page"></div>
</body>
</html>